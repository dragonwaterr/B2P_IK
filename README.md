# B2P_IK - 성경 PPT 생성기

개역개정 성경구절 PPT 생성을 위한 프로그램 v2입니다.

## 📋 v2 주요 수정사항

- ✅ 누락되었던 '레위기', '신명기' 데이터 추가
- ✅ 성경이름 뒤에 공백 상관없이 장수 입력 가능하도록 수정
  - `{성경이름} {장}:{절}` / `{성경이름}{장}:{절}` 모두 가능
- ✅ PPT 생성할 성경구절 범위 입력 후 Enter 키 눌렀을 때, 곧바로 PPT 생성 버튼 실행되도록 처리

## 🚀 기능 요약

- 📝 PPT로 생성하고 싶은 성경 구절을 입력할 수 있습니다.
- 📁 출력 폴더 경로를 지정할 수 있습니다.
- 💾 저장할 파일 이름을 지정할 수 있습니다.
- 🎨 PPT 템플릿 양식은 3개까지 제공합니다.
  - 각 템플릿은 모두 다음 3개의 텍스트 박스만 가지고 있으며, 해당 이름을 가진 박스 3개만 인식하므로, 다른 텍스트 박스를 만들거나 기존 텍스트 박스를 삭제하지 마세요.
    - **성경책이름 + 장 번호**: `TitleBox`
    - **구절 번호**: `VerseBox`
    - **본문내용**: `ContentBox`
- 🖼️ 템플릿의 배경이미지를 선택할 수 있습니다. (컴퓨터에 이미지가 존재하기만 하면 됩니다.)
  - 지정한 이미지 이름은 선택박스 아래 작은 회색글씨로 나타납니다.
- 🗑️ 템플릿에 지정한 배경이미지를 삭제할 수 있습니다.
- 📏 템플릿마다 한 슬라이드에 들어갈 본문 글자수를 지정할 수 있습니다.
- ✏️ 템플릿을 편집할 수 있습니다.
- 🏷️ 템플릿 3개의 이름을 수정할 수 있습니다.
- ⚡ PPT 생성버튼을 누르면 PPT가 생성됩니다.
- 📚 아래쪽에 '성경책이름-약어' 쌍 사전을 제공합니다.

---

## 🛠️ 개발 환경 설정

### 필수 요구사항

- Python 3.7 이상
- pip (Python 패키지 관리자)

### 설치 방법

1. **저장소 클론**
   ```bash
   git clone https://github.com/dragonwaterr/B2P_IK.git
   cd B2P_IK
   ```

2. **필요한 패키지 설치**
   ```bash
   pip install python-pptx webdriver-manager
   ```

3. **성경 데이터 준비**
   - `data/cache/bible_data.json` 파일이 필요합니다.
   - 이 파일이 없다면 성경 데이터를 별도로 준비해야 합니다.

4. **프로그램 실행**
   ```bash
   python main.py
   ```

---

## 📦 실행 파일 패키징

### PyInstaller를 사용한 패키징

1. **PyInstaller 설치**
   ```bash
   pip install pyinstaller
   ```

2. **아이콘 파일 준비**
   - `logo1.jpg`를 [icoconvert.com](https://icoconvert.com/) 등에서 `logo1.ico`로 변환하여 프로젝트 루트에 저장하세요.

3. **실행 파일 생성**
   - 아래 명령어를 실행하면, `B2P_IK.exe`가 현재 B2P_IK 폴더(루트)에 바로 생성됩니다.
   - 반드시 `main.py`가 있는 폴더에서 실행하세요.
   ```bash
   pyinstaller --onefile --windowed --icon=logo1.ico --name B2P_IK main.py
   ```
   - 옵션 설명:
     - `--onefile` : 단일 exe로 패키징
     - `--windowed` : 콘솔창 없이 GUI만 실행
     - `--icon=logo1.ico` : 아이콘 지정 (ico 파일 필요)
     - `--name B2P_IK` : 실행파일 이름 지정

4. **배포 준비**
   - 생성된 `B2P_IK.exe` 파일을 B2P_IK 폴더(루트)에 둡니다.
   - `data`, `templates` 폴더와 같은 위치에 두세요.
   - `hide_folders.bat`, `사용설명서.txt` 파일도 함께 배포하세요.

### 주의사항

- **패키징된 실행 파일은 `data`, `templates` 폴더와 같은 디렉토리에 있어야 정상 동작합니다. (data, templates, 패키징한 실행파일이 같은 디렉토리에 있어야함.)**
- 실행 파일만 별도로 이동시키면 프로그램이 정상동작하지 않습니다.
- 배포 시에는 전체 폴더 구조를 유지해야 합니다.

---

## 📖 기능 사용법

### 1. 생성할 구절범위 입력

- **여러가지 성경을 약어/풀네임 중에 하나로 입력할 수 있습니다.**
  - `창 1:1-3` OR `창세기 1:1-3` 모두 가능

- **책이름 뒤에 공백은 자유입니다.**
  - `창1:1-3` / `창 1:1-3` 둘 다 가능

- **장수 뒤에는 ':'(콜론)을 입력하고 구절번호를 입력합니다.**
  - ✅ 옳은 예시: `창 1:1-3`
  - ❌ 틀린 예시: `창 1.1-3`

- **생성할 구절번호 범위는 '-' (하이픈)을 통해 연결합니다**
  - ✅ 옳은 예시: `창 1:1-3`
  - ❌ 틀린 예시: `창 1:1~3`

- **',' (쉼표)를 기준으로 같은 책이름의 여러 구절을 한번에 입력할 수 있습니다.**
  - 예시: `창 1:1-3, 2:1-2` (쉼표뒤에 공백은 자유)

- **';' (세미콜론)을 기준으로 여러권의 책을 한번에 입력할 수 있습니다.**
  - 예시: `창 1:1-3; 왕상 3:1-5` (세미콜론 뒤에 공백은 자유)

- **마지막으로 생성하는 책이름 끝에는 ';' 세미콜론을 붙이지 않아도 됩니다.**

### 2. 결과 PPT 출력폴더 지정

- '폴더 선택' 버튼을 눌러서 결과물 PPT를 생성할 위치를 지정할 수 있습니다.

### 3. 저장할 PPT 파일명 지정

- '저장 파일명:' 칸에 원하는 이름으로 PPT 파일을 생성할 수 있습니다.
- 파일명 끝에 '.pptx' 확장자를 붙이면 그대로 생성되고, 파일 이름만 넣어도 '.pptx' 확장자를 자동으로 붙여서 생성합니다.
  - 예시 입력1: `output` → 생성된 파일명: `output.pptx`
  - 예시 입력2: `output.pptx` → 생성된 파일명: `output.pptx`
  - 예시 입력3: `output.abc` → 생성된 파일명: `output.abc.pptx`

### 4. 생성/편집할 템플릿 선택

- '템플릿:' 부분 오른쪽에서, 현재 생성/편집할 템플릿을 선택할 수 있습니다.

### 5. 배경이미지 선택/삭제

- **배경 이미지 선택**: '배경 이미지 선택' 버튼을 클릭하면 현재 컴퓨터에 존재하는 이미지 파일을 템플릿의 배경으로 지정할 수 있습니다. 버튼 아래에 작게 현재 등록된 이미지 이름이 회색글씨로 나타납니다.
- **배경 이미지 삭제**: '배경 이미지 삭제' 버튼을 클릭하면 현재 등록된 템플릿 배경 이미지가 삭제됩니다.

### 6. 각 템플릿마다 한 슬라이드의 구절 최대 글자 수 지정가능

- 한 슬라이드마다 본문내용을 몇 글자에서 끊을지 지정할 수 있습니다. (글자 수는 공백포함)
- 최대 글자 수를 초과한 나머지 본문 내용은 뒤 슬라이드에 자동으로 생성됩니다.

### 7. 템플릿 편집

- '템플릿 편집' 버튼을 누르면 현재 선택된 템플릿 양식이 PPT 파일이 열립니다.
  - 배경이미지가 적용되지 않았다고 오류가 생긴게 아닙니다. PPT 생성을 할 때 배경 이미지가 적용되므로, 그냥 진행하면 됩니다.
  - **3개의 텍스트박스의 위치를 이동하고 크기를 조정해도 되지만, 절대 삭제하지 마세요!**
  - 만약 실수로 삭제했다면, 텍스트 박스의 이름을 위 기능요약에 설명한 것처럼 수정해야 합니다.
  - 도형은 자유롭게 넣으셔도 됩니다.
  - 편집을 마쳤다면 저장하고 닫으시면 됩니다.

### 8. 템플릿 이름 수정

- '템플릿 이름 수정' 버튼을 클릭하여, 3개의 템플릿 이름을 수정할 수 있습니다.

### 9. PPT 생성

- 지정한 출력 폴더에 저장 파일명에 지정한 이름의 PPT가 생성됩니다.
- **Enter 키를 눌러서 바로 PPT 생성도 가능합니다!**

### 10. 성경 [책이름-약어] 사전

- 약어가 기억안날때 참고하시면 됩니다.
- 스크롤 OR 이름검색으로 찾을 수 있습니다.

---

## 📝 사용 예시

```
# 기본 사용법
창1:1-3,2:1-2; OR 창 1:1-3,2:1-2

# 여러 책 조합 (공백 자유)
요일4:1-3;요이1:1-5; 요삼1:1-4

# 복잡한 조합
창세기1:1-31,2:1-25;출애굽기3:1-22;레위기1:1-17
```

---

## 📁 프로젝트 구조

```
B2P_IK/
├── main.py                  # 프로그램 진입점 (패키징 대상)
├── core/
│   └── ppt_generator.py     # PPT 생성 핵심 로직
├── ui/
│   └── gui.py               # GUI 인터페이스 (def main() 포함)
├── data/
│   ├── cache/
│   │   └── bible_data.json  # 개역개정 성경 데이터 파일
│   ├── config.json
│   └── bg_images.json
├── templates/               # PPT 템플릿 파일들
├── B2P_IK.exe               # 패키징된 실행 파일 (직접 생성됨)
├── hide_folders.bat
├── 사용설명서.txt
└── README.md
```

---

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

---

**updated 2025-07-06 (v2)**  
*written by dragonwaterr.* 

---

## 📦 실제 사용(배포)시 폴더 구조 예시

```
B2P_IK/
├── B2P_IK.exe            # 실행 파일 (패키징 후 생성 : 바로가기 만들어서 사용 권장)
├── templates/            # PPT 템플릿 폴더 (숨김 처리 권장)
├── data/                 # 성경 데이터 및 설정 폴더 (숨김 처리 권장)
├── hide_folders.bat      # 폴더 숨김 처리용 배치파일
└── 사용설명서.txt        # 사용자 설명서
```

- **templates, data 폴더는 숨김 처리되어 있을 수 있습니다.**
- 반드시 위 파일/폴더들이 모두 같은 디렉토리에 있어야 정상 동작합니다.
- `hide_folders.bat`를 실행하면 templates, data 폴더가 숨김 처리됩니다.

--- 